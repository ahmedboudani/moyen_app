# إعداد Supabase مع نظام إدارة التلاميذ

هذا الدليل يشرح كيفية ربط تطبيق Flask بقاعدة بيانات Supabase.

## المتطلبات الأساسية
- حساب على [Supabase](https://supabase.com/)
- مشروع Supabase جديد
- مكتبة supabase مثبتة (`pip install supabase`)

## الخطوات

### 1. إنشاء مشروع Supabase
1. قم بإنشاء حساب جديد على [Supabase](https://supabase.com/)
2. انقر على "New Project"
3. اختر منظمتك أو أنشئ منظمة جديدة
4. أدخل اسم المشروع وكلمة المرور لقاعدة البيانات
5. اختر المنطقة الأقرب لك
6. انقر على "Create new project"

### 2. الحصول على معلومات الاتصال
1. بعد إنشاء المشروع، اذهب إلى إعدادات المشروع (Settings)
2. انقر على "Database"
3. انسخ "Connection string" - ستحتاج هذا الرابط لتوصيل تطبيقك
4. انسخ "Project URL" و "anon public key" من إعدادات API

### 3. إنشاء الجداول في قاعدة البيانات
1. اذهب إلى قسم "SQL Editor" في لوحة تحكم Supabase
2. قم بتشغيل ملف `setup_supabase.py` محليًا للحصول على أوامر SQL:
   ```bash
   python setup_supabase.py
   ```
3. انسخ الأوامر والصقها في محرر SQL في Supabase
4. انقر على "Run" لتنفيذ الأوامر

### 4. إعداد متغيرات البيئة
1. في منصة النشر (Vercel/Railway/غيرها)، أضف متغيرات البيئة التالية:
   - `DATABASE_URL`: رابط اتصال قاعدة البيانات من Supabase
   - `SUPABASE_URL`: رابط مشروع Supabase
   - `SUPABASE_KEY`: مفتاح API العام (anon key) من Supabase
   - `SECRET_KEY`: مفتاح سري عشوائي

### 5. اختبار الاتصال
1. قم بنشر تطبيقك
2. حاول تسجيل الدخول أو إنشاء حساب جديد
3. تحقق من أن البيانات تظهر في لوحة تحكم Supabase

## استكشاف الأخطاء وإصلاحها

### مشاكل شائعة
1. **خطأ في الاتصال بقاعدة البيانات**
   - تحقق من صحة رابط قاعدة البيانات
   - تأكد من أن كلمة المرور صحيحة
   - تحقق من أن قاعدة البيانات نشطة

2. **خطأ في المصادقة**
   - تحقق من صحة مفتاح API
   - تأكد من أن الجداول لها الأذونات الصحيحة

3. **مشاكل في الترميز (Encoding)**
   - تأكد من أن قاعدة البيانات تدعم اللغة العربية (UTF-8)
   - تحقق من إعدادات الترميز في Supabase

### الحصول على المساعدة
- [وثائق Supabase](https://supabase.com/docs)
- [مجتمع Supabase](https://github.com/supabase/supabase/discussions)
- [قناة Discord الخاصة بـ Supabase](https://discord.supabase.com/)

## ملاحظات هامة
- Supabase يوفر خطة مجانية سخية، ولكن لها حدود معينة
- في بيئة الإنتاج، تأكد من تأمين قاعدة البيانات بشكل صحيح
- يمكنك استخدام Supabase Auth للمصادقة بدلاً من نظام المصادقة المدمج في Flask
